Preprocessing data...
Aggregating data...
Aggregating observations...
Processing observations: 100%|████████████████████████████████| 40761/40761 [00:27<00:00, 1487.03it/s]
Merging data...
Merging steps: 100%|████████████████████████████████████████████████████| 5/5 [00:01<00:00,  4.37it/s]
Formatting final text...

Class distribution before balancing:
label
non-COVID    216676
COVID-19       6406
Name: count, dtype: int64

Class distribution after balancing:
label
non-COVID    216676
COVID-19     216676
Name: count, dtype: int64
Creating CSV from Arrow format: 100%|██████████████████████████████| 434/434 [00:01<00:00, 373.45ba/s]
Creating CSV from Arrow format: 100%|████████████████████████████████| 32/32 [00:00<00:00, 389.57ba/s]
Creating CSV from Arrow format: 100%|████████████████████████████████| 67/67 [00:00<00:00, 392.58ba/s]

Final dataset statistics:
Train size: 433352
Validation size: 31644
Test size: 66802

Class distribution in final training set:
label
non-COVID    216676
COVID-19     216676
Name: count, dtype: int64

Data preparation complete. Dataset saved to: processed_data
